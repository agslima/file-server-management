# ADR 0007: Upload Staging + Malware Scan Gate Before Commit

- Status: Proposed
- Date: 2026-01-28

## Context
Direct upload to final filesystem risks malware persistence and can overload file servers.

## Decision

Uploads must:
1) land in staging storage,
2) pass allowlist validation (type/size),
3) be scanned by ClamAV,
4) only then be moved/committed by the File Engine.

Infected files must be quarantined.

## Consequences

- Strong security posture
- Additional operational components (staging + scanning pool + quarantine lifecycle)

## Alternatives considered

- Scan after commit (rejected: unacceptable risk)
